{% extends 'accounts/base.html' %}
{% load static %}
{% load humanize %}

{% block content %}
  <div class="container-fluid py-5">
    <div class="card shadow border-0 rounded-lg">
      <div class="card-header text-center bg-warning text-white">
        <h3 class="font-weight-light mb-0">Your Cart</h3>
      </div>
      <div class="card-body">
        {% if cart.items.exists %}
          <div class="mb-4">
            <h5 class="text-primary">Cart Items</h5>
            <ul class="list-group">
              {% for item in cart.items.all %}
                <li class="list-group-item d-flex justify-content-between align-items-center">
                  <div>
                    <h6 class="mb-1">
                      <span class="text-primary fw-bold">{{ item.product.name }}</span> |
                      <span class="text-success">{{ item.product.category }}</span> |
                      <span class="text-info">{{ item.product.gender }}</span> |
                      <span class="text-warning">{{ item.volume.product_type }}</span>
                    </h6>

                    <small>
                      {{ item.volume.volume.ml }}ML (x{{ item.quantity }}) @{% if item.volume.discount_value %}
                        <del class="text-muted">UgX {{ item.volume.volume.price|floatformat:'2'|intcomma }}</del>
                        <span class="text-danger">UgX {{ item.volume.get_discounted_price|floatformat:'2'|intcomma }}</span>
                        ({{ item.volume.discount_value|floatformat:'2' }}% Off)
                      {% else %}
                        UgX {{ item.volume.volume.price|floatformat:'2'|intcomma }}
                      {% endif %}each
                    </small>
                  </div>
                  <span class="badge bg-primary rounded-pill">UgX {{ item.get_total_price|floatformat:'2'|intcomma }}</span>
                </li>
              {% endfor %}
            </ul>
          </div>

          <div class="d-flex justify-content-between align-items-center mb-4">
            <strong>Total Price:</strong>
            <h5 class="text-primary mb-0">UgX {{ total_price|floatformat:'2'|intcomma }}</h5>
          </div>

          <a href="{% url 'orders:checkout' %}" class="btn btn-success btn-lg w-100"><i class="bi bi-credit-card"></i> Proceed to Checkout</a>
        {% else %}
          <div class="alert alert-info" role="alert">Your cart is empty.</div>
        {% endif %}
      </div>
    </div>
  </div>
{% endblock %}
